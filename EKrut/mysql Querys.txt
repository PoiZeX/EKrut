# SELECT ALL ORDERS AND GET MACHINE LOCATION + REGION for orders report #
SELECT machines.machine_id, machines.location, regions.region_name, orders.total_sum
FROM orders
JOIN machines ON orders.machine_id = machines.machine_id
JOIN regions ON machines.region_id = regions.region_id
WHERE regions.region_name = 'regionname' AND orders.is_delivery = 0;

# GROUPED BY LOCATION OF MACHINE # 

SELECT machines.machine_id, machines.location, regions.region_name, orders.time,
SUM(orders.total_sum) as total_sum, COUNT(*) as num_orders
FROM orders
JOIN machines ON orders.machine_id = machines.machine_id
JOIN regions ON machines.region_id = regions.region_id
WHERE orders.is_delivery = 0
GROUP BY machines.location 

## count orders amount : users amount
SELECT
  orders_made,
  COUNT(*) as user_amount
FROM (
  SELECT user_id, COUNT(*) as orders_made
  FROM orders
  GROUP BY user_id
) t
GROUP BY orders_made;

## count delivery method amount 
SELECT
  supply_method,
  COUNT(*) as num_orders
FROM orders
GROUP BY supply_method;
